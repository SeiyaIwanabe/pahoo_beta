<div class="showHeader">
  <%= link_to :back, class: "backLink" do %><button></button><% end%>
  <p class="postOwnerName"><%= @post.user.nickname %></p>
  <h1>投稿</h1>
</div>

<div class="PickupContent">
  <%= video_tag(@post.post_video.to_s, controls: true, playsinline: true, class: "scallPostVideo") %>
  <%= link_to user_path(@post.user.id), class: "scallProfileLink" do %>
    <% if @post.user.icon? %>
      <%= image_tag @post.user.icon.url, class: "user-icon"%>
    <% else %>
      <i class="fas fa-user-circle"></i>
    <% end %>
    <p class="user-nickname"><%= @post.user.nickname %></p>
  <% end %>

  <!--いいねリンク -->
  <% if current_user.already_favorited?(@post) %>
    <%= link_to post_favorites_path(@post), method: :delete, class: "goodLink" do %>
      <i class="fas fa-heart"></i>
    <% end %>
  <% else %>
    <%= link_to post_favorites_path(@post), method: :post, class: "goodLink" do %>
      <i class="far fa-heart"></i>
    <% end %>
  <% end %>
  <p class="favoriteCount"><%= @post.favorites.count %></p>

  <!--コメントリンク -->
  <%= link_to "#", class: "commentLink" do%>
    <i class="far fa-comment-dots"></i>
  <% end %>

  <!--シェアリンク -->
  <%= link_to "#", class: "shareLink" do%>
    <i class="fas fa-share"></i>
  <% end %>
  
  <div class="postText"><%= @post.post_text %></div>
  <%# <%= link_to "投稿削除", post_path(post.id), method: :delete, class: "postDeleteBtn" %>
</div>

<!-- 黒背景 -->
<label id="js-nav-close"></label>

<!-- シェアナビゲーション -->
<nav id="shareNav">
  <li>
    <i class="fab fa-twitter"></i>
    <%= link_to 'Twitterで共有', "https://twitter.com/share?url=#{request.url}", title: @post.post_text, target: '_blank', class: "postShareLink" %>
  </li>
  <li>
    <i class="fab fa-facebook"></i>
    <iframe src="https://www.facebook.com/plugins/share_button.php?href=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&layout=button&size=large&width=79&height=28&appId" width="79" height="28" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowfullscreen="true" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share"></iframe>
    <!--<%= link_to 'FaceBookで共有(仮)', class: "postShareLink" %>-->
  </li>
  <li>
    <i class="fab fa-line"></i> 
    <%= link_to 'Lineで共有(仮)', "#" , class: "postShareLink" %>
  </li>
</nav>

<!-- コメントナビゲーション -->
<nav id="commentNav">
  <p class="commentCount"><%= @comments.count %>件のコメント</p>
  <% if @comments %>
    <div class="commentOutline">
      <% @comments.each do |comment| %>
        <li>
          <div class="topPosition">
            <%= link_to user_path(@post.user.id), class: "commentUserLink" do %>
              <% if comment.user.icon? %>
                <%= image_tag comment.user.icon.url, class: "commentUserIcon"%>
              <% else %>
                <i class="fas fa-user-circle"></i>
              <% end %>
              <p class="commentUserName"><%= comment.user.nickname %></p>
            <% end%>
            <% if comment.user_id == current_user.id %>
              <%= link_to post_comment_path(@post, comment), method: :delete, class: "deleteCommentLink" do %>
                <i class="fas fa-trash"></i>
              <% end %>
            <% end %>
          </div>
          <div class="bottomPosition">
            <p class="commentContent"><%= comment.content %></p>
            <p class="commentDatetime"><%= comment.created_at.strftime('%Y/%m/%d') %></p>
          </div>
        </li>
      <% end %>
    </div>
  <% else %>
    <p>コメントはまだありません</p>
  <% end %>

  <div class="bottomInput">
    <%= form_with(model: [@post, @comment], id: "new-comment", local: true) do |f| %>
      <%= f.text_field :content, class: "inputComment" %>
      <%= f.submit "コメントする", class: "submitComment" %>
    <% end %>
  </div>
</nav>


<!-- ユーザーの他の投稿一覧 -->
<div class="userOthersPosted">
  <p><span><%= @post.user.nickname %></span>さんの他の投稿</p>
  <% @posts.each do |post| %>
    <%= link_to post_path(post.id), class: "postScallLink" do %>
      <%= video_tag(post.post_video.to_s, autoplay: true, muted: true, loop: true, playsinline: true, class: "otherContents") %>
    <% end %>
  <% end %>
</div>

<%= render partial: "modules/footer" %>

<%= javascript_include_tag 'shareLink' %>
<%= javascript_include_tag 'post-comment' %>


